{
  "allowRemoteResourceManagement": true,
  "policyEnforcementMode": "ENFORCING",
  "resources": [
    {
      "name": "Default Resource",
      "uri": "/*",
      "type": "urn:sbauthz-app:resources:default",
      "scopes": []
    },
    {
      "name": "Identity Resource",
      "uri": "/api/authz/checkIdentity",
      "type": "urn:sbauthz-app:resources:identity",
      "scopes": []
    }
  ],
  "policies": [
    {
      "name": "Only Owner Policy",
      "description": "Defines that only the resource owner is allowed to do something",
      "type": "js",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "code": "$evaluation.grant();"
      }
    },
    {
      "name": "Any Admin Policy",
      "description": "Defines that administrators can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"admin\",\"required\":true}]"
      }
    },
    {
      "name": "Any Manager Policy",
      "description": "Defines that resource managers can do something",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"manager\",\"required\":true}]"
      }
    },
    {
      "name": "Any User Policy",
      "description": "Defines that only users from well known clients are allowed to access",
      "type": "role",
      "logic": "POSITIVE",
      "decisionStrategy": "UNANIMOUS",
      "config": {
        "roles": "[{\"id\":\"user\",\"required\":true}]"
      }
    },
    {
      "name": "Only Owner and Manager Policy",
      "description": "Defines that only the resource owner and manager can do something",
      "type": "aggregate",
      "logic": "POSITIVE",
      "decisionStrategy": "AFFIRMATIVE",
      "config": {
        "applyPolicies": "[\"Any Manager Policy\",\"Only Owner Policy\"]"
      }
    }
  ],
  "scopes": [
  ]
}